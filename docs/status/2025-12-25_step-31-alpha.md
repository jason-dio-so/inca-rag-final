## ✅ STEP 31-α: General Premium Multiplier Table Integration (Frontend-only)
**Status:** COMPLETE
**Commit:** [current]
**Date:** 2025-12-25

**Purpose:**
Integrate Excel multiplier table (일반보험요율예시.xlsx) as embedded Frontend SSOT and enhance premium calculation logic with coverageName/insurer lookup.

**Constitutional Principles:**
- ✅ Proposal-centered system maintained
- ✅ Backend Contract (STEP 14-26) immutable
- ✅ No runtime Excel parsing (embedded data)
- ✅ Data absence ≠ error (graceful PARTIAL fallback)

**Core Definitions:**
- Multiplier source: `GENERAL_MULTIPLIERS_BY_COVERAGE` (28 coverages × 8 insurers)
- Excel interpretation: 117 → 1.17 (percent/100)
- Calculation: generalPremium = Math.round(basePremium × multiplier)

**Deliverables:**

1. **Multiplier Table SSOT**
   - `apps/web/src/lib/premium/multipliers.ts`
   - `GENERAL_MULTIPLIERS_BY_COVERAGE` as const object
   - `getGeneralMultiplier(coverageName, insurer)` lookup function
   - 28 coverage names, 8 insurer codes (InsurerCode type)
   - No runtime parsing (deployment-independent)

2. **Enhanced Calculation Logic**
   - `apps/web/src/lib/premium/calc.ts` updated
   - `PremiumInputExtended` interface (adds coverageName, insurer)
   - `computePremiums()` enhanced with multiplier priority:
     1. Explicit multiplier param (backward compatible)
     2. Lookup via getGeneralMultiplier(coverageName, insurer)
     3. undefined → general becomes PARTIAL
   - Existing API preserved (no breaking changes)

3. **DEV_MOCK_MODE with Real Multipliers**
   - `apps/web/src/lib/api/mocks/priceScenarios.ts` updated
   - `createReadyPremiumResult()` now uses computePremiums()
   - Coverage: "암진단비" (real multipliers from table)
   - Example verification:
     - SAMSUNG: basePremium 100,000 → general 117,000 (1.17 ✅)
     - KB: basePremium 100,000 → general 132,000 (1.32 ✅)
     - MERITZ: basePremium 100,000 → general 155,000 (1.55 ✅)

4. **Test Coverage Extension**
   - `tests/ui/test_step31_premium_calc.py` updated
   - New test cases (4 additional):
     - Case 5: Lookup success → general READY with correct value
     - Case 6: Coverage not in table → general PARTIAL
     - Case 7: Insurer not in table → general PARTIAL
     - Case 8: Backward compatibility (explicit multiplier precedence)
   - DoD verification tests (3 additional)

**Multiplier Lookup Priority:**
1. **Explicit multiplier param** (backward compatibility)
   - Uses provided multiplier value, ignores table lookup
2. **Table lookup** (STEP 31-α)
   - getGeneralMultiplier(coverageName, insurer) from embedded table
3. **Fallback to PARTIAL** (graceful degradation)
   - Lookup fails → general=PARTIAL, nonCancellation=READY

**Test Results:**
- Unit tests: 26/26 PASS ✅ (19 STEP 31 + 4 lookup + 3 DoD 31-α)
- Backward compatibility: Verified
- Constitutional compliance: All principles maintained

**DoD Achieved:**
- ✅ Multiplier table embedded as SSOT (multipliers.ts)
- ✅ computePremiums() supports coverageName/insurer lookup
- ✅ Backward compatible (explicit multiplier param takes precedence)
- ✅ DEV_MOCK_MODE uses real multipliers (verified with 암진단비)
- ✅ Tests extended (4 lookup cases + 3 DoD)
- ✅ Backend Contract/Golden snapshots unchanged (0 modifications)
- ✅ STATUS.md updated

**Key Files:**
- `apps/web/src/lib/premium/multipliers.ts` (NEW)
- `apps/web/src/lib/premium/calc.ts` (MODIFIED)
- `apps/web/src/lib/api/mocks/priceScenarios.ts` (MODIFIED)
- `tests/ui/test_step31_premium_calc.py` (MODIFIED)

**Next Steps (Future):**
1. ~~Real proposal data integration (8 insurers)~~ → Premium API integration (STEP 32) ✅
2. Policy evidence extraction for multiplier validation
3. UI enhancement (show multiplier source in tooltip)

---

